import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
from matplotlib.patches import Patch
import matplotlib.colors as mcolors

# –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã
months = ['–Ø–Ω–≤', '–§–µ–≤', '–ú–∞—Ä', '–ê–ø—Ä', '–ú–∞–π', '–ò—é–Ω', 
          '–ò—é–ª', '–ê–≤–≥', '–°–µ–Ω', '–û–∫—Ç', '–ù–æ—è', '–î–µ–∫']

data = {
    # –§—Ä—É–∫—Ç—ã
    '–ê–±—Ä–∏–∫–æ—Å—ã': [0, 0, 0, 0, 1, 2, 3, 3, 3, 2, 0, 0],
    '–ê–ø–µ–ª—å—Å–∏–Ω—ã': [3, 3, 3, 3, 3, 1, 0, 0, 0, 1, 3, 3],
    '–ê—Ä–±—É–∑—ã': [0, 0, 0, 0, 0, 1, 3, 3, 3, 2, 2, 0],
    '–ë–∞–Ω–∞–Ω—ã': [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
    '–ì—Ä–∞–Ω–∞—Ç': [1, 0, 0, 0, 0, 0, 0, 0, 1, 3, 3, 3],
    '–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç': [3, 3, 0, 0, 0, 0, 0, 0, 0, 1, 3, 3],
    '–ì—Ä—É—à–∞': [3, 3, 3, 3, 3, 3, 3, 1, 3, 1, 3, 3],
    '–î—ã–Ω—è': [0, 0, 0, 0, 0, 0, 1, 3, 3, 1, 0, 0],
    '–ò–Ω–∂–∏—Ä': [0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 3, 0],
    '–ú–∞–Ω–≥–æ': [0, 0, 1, 3, 3, 3, 3, 3, 2, 2, 2, 0],
    '–ú–∞–Ω–¥–∞—Ä–∏–Ω—ã': [3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3],
    '–ù–µ–∫—Ç–∞—Ä–∏–Ω': [0, 0, 0, 0, 0, 1, 3, 3, 3, 1, 0, 0],
    '–ü–µ—Ä—Å–∏–∫': [0, 0, 0, 0, 0, 1, 3, 3, 3, 1, 0, 0],
    '–°–ª–∏–≤–∞': [0, 0, 0, 0, 1, 3, 3, 3, 1, 1, 0, 0],
    '–•—É—Ä–º–∞': [1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 3, 3],
    '–Ø–±–ª–æ–∫–∏': [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
    
    # –Ø–≥–æ–¥—ã
    '–í–∏–Ω–æ–≥—Ä–∞–¥': [3, 3, 3, 3, 3, 3, 1, 3, 3, 3, 2, 2],
    '–ß–µ—Ä–µ—à–Ω—è': [0, 0, 0, 0, 1, 3, 1, 0, 0, 0, 0, 0],
    '–ö–ª—É–±–Ω–∏–∫–∞': [0, 0, 0, 0, 1, 3, 3, 3, 3, 0, 0, 0],
    '–í–∏—à–Ω—è': [0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0],
    '–ú–∞–ª–∏–Ω–∞': [0, 0, 0, 0, 0, 0, 1, 3, 3, 0, 0, 0],
    '–ï–∂–µ–≤–∏–∫–∞': [0, 0, 0, 0, 0, 0, 1, 3, 3, 0, 0, 0],
    '–ö—Ä—ã–∂–æ–≤–Ω–∏–∫': [0, 0, 0, 0, 0, 0, 1, 3, 3, 0, 0, 0],
    '–ó–µ–º–ª—è–Ω–∏–∫–∞': [0, 0, 0, 0, 0, 3, 3, 3, 3, 0, 0, 0],
    
    # –û–≤–æ—â–∏
    '–ë–∞–∫–ª–∞–∂–∞–Ω—ã': [0, 0, 0, 0, 0, 0, 1, 3, 3, 1, 0, 0],
    '–ö–∞–±–∞—á–∫–∏': [0, 0, 1, 3, 3, 3, 3, 3, 3, 1, 0, 0],
    '–ö–∞–ø—É—Å—Ç–∞ –±–µ–ª.': [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
    '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å (–º–æ–ª.)': [0, 0, 0, 0, 0, 3, 3, 3, 3, 0, 0, 0],
    '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å (–∑–∞–ø.)': [3, 3, 3, 3, 3, 2, 0, 0, 0, 3, 3, 0],
    '–û–≥—É—Ä—Ü—ã': [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
    '–ü–æ–º–∏–¥–æ—Ä—ã': [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
    '–ü–µ—Ä–µ—Ü –±–æ–ª–≥.': [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
    '–†–µ–¥–∏—Å': [0, 0, 0, 0, 0, 3, 3, 3, 3, 1, 0, 0],
    '–†–µ–¥—å–∫–∞ –∑–µ–ª.': [3, 3, 3, 1, 0, 0, 0, 0, 0, 1, 3, 3],
    '–°–≤–µ–∫–ª–∞': [3, 3, 3, 3, 0, 0, 0, 3, 3, 3, 3, 3],
    '–¢—ã–∫–≤–∞': [1, 1, 0, 0, 0, 0, 0, 1, 3, 3, 3, 3],
    
    # –ì—Ä–∏–±—ã
    '–ë–µ–ª—ã–µ –≥—Ä–∏–±—ã': [0, 0, 0, 0, 0, 0, 1, 3, 3, 1, 0, 0],
    '–í–µ—à–µ–Ω–∫–∏': [3, 3, 3, 0, 0, 0, 0, 3, 0, 0, 3, 3],
    '–õ–∏—Å–∏—á–∫–∏': [0, 0, 0, 0, 0, 0, 1, 3, 3, 1, 0, 0],
    '–û–ø—è—Ç–∞': [0, 0, 0, 0, 0, 0, 0, 3, 3, 1, 0, 0],
    '–ü–æ–¥–±–µ—Ä–µ–∑–æ–≤–∏–∫–∏': [0, 0, 0, 0, 0, 0, 1, 3, 3, 1, 0, 0],
    '–ü–æ–¥–æ—Å–∏–Ω–æ–≤–∏–∫–∏': [0, 0, 0, 0, 0, 0, 1, 3, 3, 1, 0, 0],
    '–†—ã–∂–∏–∫–∏': [0, 0, 0, 0, 0, 0, 0, 3, 3, 1, 0, 0],
    '–®–∞–º–ø–∏–Ω—å–æ–Ω—ã': [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
}

# –°–æ–∑–¥–∞–µ–º DataFrame
df = pd.DataFrame(data, index=months)

# –°–æ–∑–¥–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
categories = {
    '–§–†–£–ö–¢–´': ['–ê–±—Ä–∏–∫–æ—Å—ã', '–ê–ø–µ–ª—å—Å–∏–Ω—ã', '–ê—Ä–±—É–∑—ã', '–ë–∞–Ω–∞–Ω—ã', '–ì—Ä–∞–Ω–∞—Ç', '–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç', 
               '–ì—Ä—É—à–∞', '–î—ã–Ω—è', '–ò–Ω–∂–∏—Ä', '–ú–∞–Ω–≥–æ', '–ú–∞–Ω–¥–∞—Ä–∏–Ω—ã', '–ù–µ–∫—Ç–∞—Ä–∏–Ω', 
               '–ü–µ—Ä—Å–∏–∫', '–°–ª–∏–≤–∞', '–•—É—Ä–º–∞', '–Ø–±–ª–æ–∫–∏'],
    '–Ø–ì–û–î–´': ['–í–∏–Ω–æ–≥—Ä–∞–¥', '–ß–µ—Ä–µ—à–Ω—è', '–ö–ª—É–±–Ω–∏–∫–∞', '–í–∏—à–Ω—è', '–ú–∞–ª–∏–Ω–∞', 
              '–ï–∂–µ–≤–∏–∫–∞', '–ö—Ä—ã–∂–æ–≤–Ω–∏–∫', '–ó–µ–º–ª—è–Ω–∏–∫–∞'],
    '–û–í–û–©–ò': ['–ë–∞–∫–ª–∞–∂–∞–Ω—ã', '–ö–∞–±–∞—á–∫–∏', '–ö–∞–ø—É—Å—Ç–∞ –±–µ–ª.', '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å (–º–æ–ª.)', 
              '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å (–∑–∞–ø.)', '–û–≥—É—Ä—Ü—ã', '–ü–æ–º–∏–¥–æ—Ä—ã', '–ü–µ—Ä–µ—Ü –±–æ–ª–≥.', 
              '–†–µ–¥–∏—Å', '–†–µ–¥—å–∫–∞ –∑–µ–ª.', '–°–≤–µ–∫–ª–∞', '–¢—ã–∫–≤–∞'],
    '–ì–†–ò–ë–´': ['–ë–µ–ª—ã–µ –≥—Ä–∏–±—ã', '–í–µ—à–µ–Ω–∫–∏', '–õ–∏—Å–∏—á–∫–∏', '–û–ø—è—Ç–∞', '–ü–æ–¥–±–µ—Ä–µ–∑–æ–≤–∏–∫–∏', 
              '–ü–æ–¥–æ—Å–∏–Ω–æ–≤–∏–∫–∏', '–†—ã–∂–∏–∫–∏', '–®–∞–º–ø–∏–Ω—å–æ–Ω—ã']
}

# –°–æ—Ä—Ç–∏—Ä—É–µ–º —Å—Ç–æ–ª–±—Ü—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
sorted_columns = []
for category, products in categories.items():
    sorted_columns.extend(products)

df = df[sorted_columns]

# –°–æ–∑–¥–∞–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º
plt.figure(figsize=(18, 14))

# –ü—Ä–∏—è—Ç–Ω–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ (–ø–∞—Å—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–Ω–∞)
colors = ["#F8F9FAFF", "#FFF3CDDD", "#A3CFBBD6", "#2D8C59BA"]  # –ë–µ–ª—ã–π, –∫—Ä–µ–º–æ–≤—ã–π, –º—è—Ç–Ω—ã–π, –∑–µ–ª–µ–Ω—ã–π
cmap = mcolors.ListedColormap(colors)
bounds = [0, 1, 2, 3, 4]
norm = mcolors.BoundaryNorm(bounds, cmap.N)

# –°–æ–∑–¥–∞–µ–º —Ç–µ–ø–ª–æ–≤—É—é –∫–∞—Ä—Ç—É –±–µ–∑ —Å–µ—Ç–∫–∏
im = plt.imshow(df.T, cmap=cmap, norm=norm, aspect='auto')

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ—Å–∏ - —É–±–∏—Ä–∞–µ–º –≤—Å–µ –ª–∏–Ω–∏–∏
plt.gca().spines['top'].set_visible(False)
plt.gca().spines['right'].set_visible(False)
plt.gca().spines['bottom'].set_visible(False)
plt.gca().spines['left'].set_visible(False)

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–æ–¥–ø–∏—Å–∏
plt.xticks(range(len(months)), months, fontsize=11, fontweight='medium')
plt.yticks(range(len(df.columns)), df.columns, fontsize=10)

# –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ (–ü–û –í–°–ï–ô –®–ò–†–ò–ù–ï)
current_idx = 0
for category, products in categories.items():
    # –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
    plt.axhline(y=current_idx - 0.5, color="#000000", linewidth=1.5, alpha=0.7, xmin=-0.5/len(months), xmax=1 + 0.5/len(months))
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –º–µ–∂–¥—É –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    for i in range(1, len(products)):
        plt.axhline(y=current_idx + i - 0.5, color="#4B4B4B", linewidth=0.8, alpha=0.5, xmin=-0.5/len(months), xmax=1 + 0.5/len(months))
    
    # –ü–æ–¥–ø–∏—Å–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å –ø—Ä–∏—è—Ç–Ω—ã–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º
    plt.text(len(months) + 0.5, current_idx + len(products)/2 - 0.5, category, 
             rotation=0, va='center', ha='left', 
             fontsize=12, fontweight='bold', color='#374151',
             bbox=dict(boxstyle="round,pad=0.3", facecolor='#E5E7EB', alpha=0.8))
    current_idx += len(products)

# –§–∏–Ω–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ü–û –í–°–ï–ô –®–ò–†–ò–ù–ï)
plt.axhline(y=current_idx - 0.5, color='#D1D5DB', linewidth=1.5, alpha=0.7, xmin=-0.5/len(months), xmax=1 + 0.5/len(months))

# –£–±–∏—Ä–∞–µ–º –¥–µ–ª–µ–Ω–∏—è –∏ —Å–µ—Ç–∫—É –ø–æ–ª–Ω–æ—Å—Ç—å—é
plt.tick_params(which='both', bottom=False, left=False)

# –≠–ª–µ–≥–∞–Ω—Ç–Ω–∞—è –ª–µ–≥–µ–Ω–¥–∞
legend_elements = [
    Patch(facecolor='#F8F9FA', edgecolor='#D1D5DB', label='–ù–µ –≤ —Å–µ–∑–æ–Ω–µ', linewidth=1),
    Patch(facecolor='#FFF3CD', edgecolor='#D1D5DB', label='–ù–∞—á–∞–ª–æ/–ö–æ–Ω–µ—Ü —Å–µ–∑–æ–Ω–∞', linewidth=1),
    Patch(facecolor='#A3CFBB', edgecolor='#D1D5DB', label='–í —Å–µ–∑–æ–Ω–µ', linewidth=1),
    Patch(facecolor='#2D8C5A', edgecolor='#D1D5DB', label='–ü–∏–∫ —Å–µ–∑–æ–Ω–∞', linewidth=1)
]

legend = plt.legend(handles=legend_elements, 
                   loc='upper right', 
                   bbox_to_anchor=(1.15, 1),
                   frameon=True,
                   fancybox=True,
                   shadow=True,
                   framealpha=0.9,
                   edgecolor='#D1D5DB')

# –ö—Ä–∞—Å–∏–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
plt.title('üçé –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º üçÑ', 
          fontsize=16, 
          fontweight='bold', 
          pad=20,
          color='#1F2937')

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ–Ω–∞
plt.gca().set_facecolor("#9C9C9CB3")
plt.gcf().patch.set_facecolor("#74737352")

# –ö–æ–º–ø–∞–∫—Ç–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ
plt.tight_layout()

# –î–û–ë–ê–í–õ–Ø–ï–ú –ü–û–î–ü–ò–°–ò –í –Ø–ß–ï–ô–ö–ê–• –î–õ–Ø –õ–£–ß–®–ï–ô –ß–ò–¢–ê–ï–ú–û–°–¢–ò
for i in range(len(df.columns)):
    for j in range(len(months)):
        value = df.iloc[j, i]
        # –î–æ–±–∞–≤–ª—è–µ–º —Å–∏–º–≤–æ–ª—ã –≤–º–µ—Å—Ç–æ —Ü–∏—Ñ—Ä –¥–ª—è –ª—É—á—à–µ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
        if value == 0:
            symbol = ''
        elif value == 1:
            symbol = '‚óê'
        elif value == 2:
            symbol = '‚óè'
        else:  # value == 3
            symbol = '‚óÜ'
        
        color = 'black' if value > 1 else 'gray'
        plt.text(j, i, symbol, ha='center', va='center', 
                color=color, fontsize=9, fontweight='bold')

plt.show()

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
print("\n" + "="*60)
print("üéØ –õ–£–ß–®–ï–ï –í–†–ï–ú–Ø –î–õ–Ø –ü–û–ö–£–ü–û–ö:")
print("="*60)
print("üçì –õ–µ—Ç–æ (–ò—é–Ω—å-–ê–≤–≥—É—Å—Ç) - –ó–æ–ª–æ—Ç–æ–µ –≤—Ä–µ–º—è –¥–ª—è —è–≥–æ–¥, –∫–æ—Å—Ç–æ—á–∫–æ–≤—ã—Ö —Ñ—Ä—É–∫—Ç–æ–≤ –∏ –æ–≤–æ—â–µ–π")
print("üçé –û—Å–µ–Ω—å (–°–µ–Ω—Ç—è–±—Ä—å-–ù–æ—è–±—Ä—å) - –ò–∑–æ–±–∏–ª–∏–µ —è–±–ª–æ–∫, –≥—Ä—É—à, –≥—Ä–∏–±–æ–≤ –∏ –∫–æ—Ä–Ω–µ–ø–ª–æ–¥–æ–≤") 
print("üçä –ó–∏–º–∞ (–î–µ–∫–∞–±—Ä—å-–§–µ–≤—Ä–∞–ª—å) - –°–µ–∑–æ–Ω —Ü–∏—Ç—Ä—É—Å–æ–≤—ã—Ö –∏ –∑–∏–º–Ω–∏—Ö –∑–∞–ø–∞—Å–æ–≤")
print("üå± –í–µ—Å–Ω–∞ (–ú–∞—Ä—Ç-–ú–∞–π) - –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–π –∑–µ–ª–µ–Ω–∏ –∏ —Ä–∞–Ω–Ω–∏—Ö –∫—É–ª—å—Ç—É—Ä")
print("="*60)
print("–£—Å–ª–æ–≤–Ω—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ:")
print("‚óê - –ù–∞—á–∞–ª–æ/–∫–æ–Ω–µ—Ü —Å–µ–∑–æ–Ω–∞")
print("‚óè - –í —Å–µ–∑–æ–Ω–µ") 
print("‚óÜ - –ü–∏–∫ —Å–µ–∑–æ–Ω–∞")
print("="*60)